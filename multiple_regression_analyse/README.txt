--------------------------------------------------
重回帰分析スクリプトの使用方法

Copyright(C) 2014 Reona SEKINO All Right Reserved.
--------------------------------------------------

1.分析の実行

・まず重回帰分析に利用するCSVファイルを用意します。フォーマットは、1行目がデータフィールド、2行目以降が整数または浮動小数点数からなる数値データで、それぞれカンマ区切りで入力します。

(例)
time,price,number,cost,height,width
4,360,35.6,27.89,2.5,34.0
3,357,29.8,18.9,4.8,40.1
...
etc

次に、regression.cpp、使用するcsvファイルを同一階層に置き、ターミナルでそのディレクトリに移動後、コンパイル・実行してください。

(例)
$ c++ regression.cpp
$ ./a.out sample.txt(←使用するcsvファイル)

ファイルが読み込まれたところでコンソールに入力プロンプトが表示されます。
はじめに、以下のようなメッセージが表示されます。

Which data is used as Response Variable (equal to Y)? Please enter the field name to use as Response Variable.

これは重回帰分析(multiple regression analysis)において、入力された各フィールドのうち、どのフィールドを目的変数(response variable)として利用するか、ということを聞いています。目的変数とは、重回帰分析の結果をy=b_0+b_1*x_1+b_2*x_2+...としたときの、yのことです。したがって、例えば先ほどの例の"price"というフィールドを目的変数として利用したいと考えた場合には以下のように入力します。フィールド名が正しく入力されると、"Accepted"が表示されます。

(例)
price

次に、目的変数に利用したフィールド以外のフィールドに関して、説明変数(explaination variable)として利用するかどうかを尋ねるプロンプトが表示されます。説明変数とは重回帰分析の結果をy=b_0+b_1*x_1+b_2*x_2+...としたときの、各xのことです。

Do you use the "time" field? (Please answer Y or N)

この場合、timeというフィールドを利用するかどうかを聞いています。利用する場合はY、利用しない場合はNを入力してください。正しく入力されると、全てのフィールドについて尋ねてくるので、同様に回答してください。

※重回帰分析においてこのプロセスは非常に重要です。また、データの処理に何があるもの等については予めこのプロセスで除去しておく必要性があります。

フィールドの選択が完了すると、フィールドの確認と分析実行の確認プロンプトが表示されます。

(例)
----------------
Response Variable : price
Explaination Variable : time walk area bal kosuu floor tf year 
----------------
Analysis is started in above data field settings. Pleasr confirm in "Y" or "N".

Yを押すと分析が開始されNow analysing......と表示されます。

分析が成功すると、
Analysis is completed. Please check the output file (result.txt).
失敗すると、
Analysis is not completed because the loaded data set was not correct for multiple regression analysis.
と表示されます。

以上で分析は終わりです。

2.分析結果の確認

分析が成功した場合、同一ディレクトリにresult.txtというテキストファイルが生成され、分析結果が記述されています。以下はその見方について説明していきます。

この重回帰分析スクリプトでは、最終的に算出されるt値にしたがって、使用する説明変数を変更しつつ重回帰分析を繰り返し行います。各重回帰分析ごとに結果が出力されます。

まずはじめに、重回帰分析の概要がmain informationとして表示されます。

main information
     +-count :何回めの分析か(全てのフィールドが有意となるまで重回帰分析を繰り返します)
     +-response variable :目的変数のフィールド名
     +-explaination variable :説明変数として利用するフィールド名一覧
     +-number of field :説明変数のフィールド数
     +-number of data set :サンプル数

続いて、重回帰分析の結果の偏回帰係数が表示されます。偏回帰係数とは重回帰分析の結果をy=b_0+b_1*x_1+b_2*x_2+...としたときの、各bのことです。with standardizationは標準化処理を施したデータに対して解析を行った結果であり。各フィールドの単位の違いやスケールの違いに関係なく、フィールドごとの影響の大小を定量的に評価することができるものです。without standardizationはそのような標準化処理は行わず、単純に重回帰分析を行った際にどのような係数が推定されるかということを表しています。標準化を行わない場合、生成された式の各説明変数に具体的な数値を代入した場合、目的変数の実際の数値が推定されることになります。ここで、constant termとは重回帰分析の結果をy=b_0+b_1*x_1+b_2*x_2+...としたときの、b_0、すなわち説明変数に依らない定数項のことを指しています。

次に、重回帰分析の結果の重回帰式が、実際の数値とどのくらいフィットしているかということを表す決定係数(寄与率、coefficient of determination)が表示されています。決定係数が0.7以上であれば、そのモデルはおおよそ実際のデータを表現できていると考えてよいです。決定係数が0.7を下回るようであればデータセットやフィールドの見直しをする必要性があるでしょう。

最後にt値(t_value)とその有意性(significance)についての記述があります。t値は、t検定の際の統計検定量であり、極端に（有意に）データの大小が出ている場合にそれを検知し、データに特徴があるということを示すものです。有意確率5％の場合、|t_value|>1.96の物に関しては有意性がある(significant)であると考えてよく、そうでないものに関しては有意性がない(unsignificant)であると考えます。

ここで有意性があるという結果が出たフィールドに関しては、重回帰式において有意な寄与をしているという意味合いがあり、有意性がないとされたフィールドに関しては、重回帰式に対して有意な寄与をしていない、すなわち考慮されてもされなくても同じである（同じである可能性が高い）という意味合いがあります。したがって、有意性があるとされたフィールドに絞って、次回の重回帰分析をすることになります。

このよに重回帰分析を繰り返し、全てのフィールドが有意となったところで分析を終了します。

以上
